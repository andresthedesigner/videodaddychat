Refactor the selected code to improve:

- **Readability**: Clear naming, proper formatting, logical structure
- **Maintainability**: Single responsibility, DRY principles, appropriate abstractions
- **Performance**: Optimize where applicable without premature optimization
- **Type safety**: Strict TypeScript, explicit types, proper guards

Follow the patterns in:
- `app/components/chat/use-chat-core.ts` for hooks
- `lib/chat-store/chats/provider.tsx` for context providers
- `app/api/chat/route.ts` for API routes

Preserve existing functionality and ensure all tests pass after refactoring.
